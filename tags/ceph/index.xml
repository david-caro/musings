<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ceph on David&#39;s musings and ramblings.</title>
    <link>https://musings.dcaro.es/tags/ceph/</link>
    <description>Recent content in Ceph on David&#39;s musings and ramblings.</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <copyright>Â© David Caro 2024</copyright>
    <lastBuildDate>Sat, 17 Feb 2024 23:58:16 +0100</lastBuildDate>
    <atom:link href="https://musings.dcaro.es/tags/ceph/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Adding USB Osd to Rpi Ceph Cluster</title>
      <link>https://musings.dcaro.es/posts/2024-02-17-adding-usb-osd-to-rpi-ceph-cluster/</link>
      <pubDate>Sat, 17 Feb 2024 23:58:16 +0100</pubDate>
      <guid>https://musings.dcaro.es/posts/2024-02-17-adding-usb-osd-to-rpi-ceph-cluster/</guid>
      <description>&lt;p&gt;I was trying to add some new USB disks to my ceph cluster, and then I remembered&#xA;that ceph-volume&#xA;&lt;a href=&#34;https://tracker.ceph.com/issues/38833&#34;&gt;does not support to use removable USB devices for OSDs&lt;/a&gt;&#xA;:/&lt;/p&gt;&#xA;&lt;p&gt;To do so, I had to go to the host with the new drives, and then open a&#xA;&lt;code&gt;cephadm shell&lt;/code&gt; and modify the &lt;code&gt;ceph-volume&lt;/code&gt; library:&lt;/p&gt;&#xA;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;root@node1:~# cephadm shell&#xA;Inferring fsid d49b287a-b680-11eb-95d4-e45f010c03a8&#xA;Inferring config /var/lib/ceph/d49b287a-b680-11eb-95d4-e45f010c03a8/mon.node1/config&#xA;Using recent ceph image quay.io/ceph/ceph@sha256:6d83dc7540a56ba51c05f412c3def8e2d7e624501b25e5a00e31f3d53d4cf578&#xA;&#xA;root@node1:/# vi /usr/lib/python3.6/site-packages/ceph_volume/util/disk.py&#xA;# remove the following lines:&#xA;804         if get_file_contents(os.path.join(_sys_block_path, dev, &amp;#39;removable&amp;#39;)) == &amp;#34;1&amp;#34;:&#xA;805             continue&#xA;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;That allows you to then zap and prepare the osds, but we have to set the keyring&#xA;first:&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
